// Generated by CoffeeScript 1.6.3
(function() {
  var QuickBox;

  QuickBox = (function() {
    function QuickBox() {
      var filterItems, firstMateched, items, li, lis, tHandle, _i, _len,
        _this = this;
      lis = document.querySelectorAll('.quick-box ul > li');
      items = [];
      for (_i = 0, _len = lis.length; _i < _len; _i++) {
        li = lis[_i];
        items.push(li);
      }
      firstMateched = null;
      filterItems = function(keyword) {
        var desc, item, title, _j, _len1, _results;
        firstMateched = null;
        _results = [];
        for (_j = 0, _len1 = items.length; _j < _len1; _j++) {
          item = items[_j];
          title = item.querySelector('.title').innerHTML;
          desc = item.querySelector('.desc').innerHTML;
          if (title.indexOf(keyword) !== -1 || desc.indexOf(keyword) !== -1) {
            if (!firstMateched) {
              firstMateched = item;
            }
            _results.push(item.style.display = "block");
          } else {
            _results.push(item.style.display = "none");
          }
        }
        return _results;
      };
      tHandle = null;
      this.input = $('.quick-box .quicksearch-input');
      this.input.keydown(function(e) {
        var keyword;
        if (e.keyCode === 13) {
          $(firstMateched).find('a').triggerHandler('click');
          return false;
        }
        keyword = e.currentTarget.value;
        if (tHandle) {
          clearTimeout(tHandle);
        }
        return tHandle = setTimeout((function() {
          return filterItems(_this.input.val());
        }), 50);
      });
      $('.quick-box-overlay').click(function(e) {
        return _this.hide();
      });
      $('.quick-box a').click(function(e) {
        _this.hide();
        return false;
      });
      $(document.body).keydown(function(e) {
        if (e.keyCode === 191) {
          _this.show();
          e.stopPropagation();
          e.preventDefault();
          return false;
        }
      });
    }

    QuickBox.prototype.show = function() {
      $('.quick-box-wrapper').show();
      $('.quick-box').addClass('in');
      this.input.focus();
      return this.input.select();
    };

    QuickBox.prototype.hide = function() {
      $('.quick-box').removeClass('in');
      return $('.quick-box-wrapper').hide();
    };

    return QuickBox;

  })();

  window.QuickBox = QuickBox;

}).call(this);
